{"version":3,"sources":["../../src/app/pdf-viewer/pdf-viewer.component.ts","../../src/app/utils/event-bus-utils.ts","../../src/app/utils/helpers.ts","../../src/app/pdf-viewer/pdf-viewer.module.ts"],"names":["RenderTextMode","createEventBus","pdfJsViewer","destroy$","globalEventBus","EventBus","eventBus","fromEvent","pipe","takeUntil","subscribe","event","document","createEvent","initCustomEvent","window","dispatchEvent","_a","pageNumber","cssTransform","source","div","textLayerDiv","initEvent","container","pagesCount","scale","presetValue","location","type","query","phraseSearch","caseSensitive","highlightAll","findPrevious","attachmentsCount","view","outerContainer","mode","pdfViewer","action","active","switchInProgress","outlineCount","attachDOMEventsToEventBus","assign","obj","prop","value","isSSR","PDFJS","VerbosityLevel","INFOS","PdfViewerComponent","element","ngZone","pdfWorkerSrc","this","isVisible","_cMapsUrl","version","_renderText","_renderTextMode","ENABLED","_stickToPage","_originalSize","_page","_zoom","_zoomScale","_rotation","_showAll","_canAutoResize","_fitToPage","_externalLinkTarget","_showBorders","resizeTimeout","pageScrollTimeout","isInitialized","Subject","afterLoadComplete","EventEmitter","pageRendered","pageInitialized","textLayerRendered","onError","onProgress","pageChange","hasOwnProperty","GlobalWorkerOptions","Object","defineProperty","prototype","cMapsUrl","originalPage","parseInt","_pdf","getValidPageNumber","emit","renderText","renderTextMode","originalSize","console","warn","Boolean","getLinkTarget","LinkTarget","BLANK","NONE","SELF","PARENT","TOP","ngAfterViewChecked","_this","offset","pdfViewerContainer","nativeElement","offsetParent","setTimeout","initialize","ngOnChanges","src","ngOnInit","setupResizeListener","ngOnDestroy","clear","next","loadingTask","pdfMultiPageLinkService","pdfSinglePageLinkService","getCurrentViewer","pdfMultiPageFindController","pdfSinglePageFindController","changes","loadPDF","textLayerMode","DISABLED","resetPdfDocument","page","currentValue","_latestScrolledPage","scrollPageIntoView","update","updateSize","currentViewer","from","getPage","currentPageNumber","rotation","rotate","viewportWidth","getViewport","width","CSS_UNITS","stickToPage","clientWidth","viewPort","getScale","height","_setScale","destroyed","destroy","pdfMultiPageViewer","setDocument","pdfSinglePageViewer","getPDFLinkServiceConfig","pdfLinkServiceConfig","linkTarget","externalLinkTarget","setupMultiPageViewer","PDFJSViewer","clearTimeout","PDFLinkService","PDFFindController","linkService","pdfOptions","querySelector","removePageBorders","findController","renderer","l10n","undefined","PDFViewer","setViewer","setupSinglePageViewer","PDFSinglePageViewer","_currentPageNumber","numPages","getDocumentParams","srcType","params","cMapUrl","cMapPacked","url","byteLength","data","lastLoaded","getDocument","progressData","promise","pdf","error","render","pagesRotation","viewportHeight","borderSize","BORDER_WIDTH","pdfContainerWidth","pdfContainerHeight","clientHeight","ratio","Math","min","pdfFindController","runOutsideAngular","debounceTime","filter","Component","args","selector","template","ElementRef","NgZone","ViewChild","Output","Input","NgModule","declarations","exports"],"mappings":"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","sourcesContent":["/**\n * Created by vadimdez on 21/06/16.\n */\nimport {\n  Component,\n  Input,\n  Output,\n  ElementRef,\n  EventEmitter,\n  OnChanges,\n  SimpleChanges,\n  OnInit,\n  OnDestroy,\n  ViewChild,\n  AfterViewChecked,\n  NgZone\n} from '@angular/core';\nimport { from, fromEvent, Subject } from 'rxjs';\nimport { debounceTime, filter, takeUntil } from 'rxjs/operators';\nimport * as PDFJS from 'pdfjs-dist/legacy/build/pdf';\nimport * as PDFJSViewer from 'pdfjs-dist/legacy/web/pdf_viewer';\n\nimport { createEventBus } from '../utils/event-bus-utils';\nimport { assign, isSSR } from '../utils/helpers';\n\nimport type {\n  PDFSource,\n  PDFPageProxy,\n  PDFProgressData,\n  PDFDocumentProxy,\n  PDFDocumentLoadingTask,\n  PDFViewerOptions\n} from './typings';\n\nif (!isSSR()) {\n  assign(PDFJS, 'verbosity', PDFJS.VerbosityLevel.INFOS);\n}\n\nexport enum RenderTextMode {\n  DISABLED,\n  ENABLED,\n  ENHANCED\n}\n\n@Component({\n  selector: 'pdf-viewer',\n  template: `\n    <div #pdfViewerContainer class=\"ng2-pdf-viewer-container\">\n      <div class=\"pdfViewer\"></div>\n    </div>\n  `,\n  styleUrls: ['./pdf-viewer.component.scss']\n})\nexport class PdfViewerComponent\n  implements OnChanges, OnInit, OnDestroy, AfterViewChecked {\n  static CSS_UNITS = 96.0 / 72.0;\n  static BORDER_WIDTH = 9;\n\n  @ViewChild('pdfViewerContainer') pdfViewerContainer;\n\n  private isVisible = false;\n  private pdfMultiPageViewer: any;\n  private pdfMultiPageLinkService: any;\n  private pdfMultiPageFindController: any;\n\n  private pdfSinglePageViewer: any;\n  private pdfSinglePageLinkService: any;\n  private pdfSinglePageFindController: any;\n\n  private _cMapsUrl =\n    typeof PDFJS !== 'undefined'\n      ? `https://unpkg.com/pdfjs-dist@${(PDFJS as any).version}/cmaps/`\n      : null;\n  private _renderText = true;\n  private _renderTextMode: RenderTextMode = RenderTextMode.ENABLED;\n  private _stickToPage = false;\n  private _originalSize = true;\n  private _pdf: PDFDocumentProxy;\n  private _page = 1;\n  private _zoom = 1;\n  private _zoomScale: 'page-height' | 'page-fit' | 'page-width' = 'page-width';\n  private _rotation = 0;\n  private _showAll = true;\n  private _canAutoResize = true;\n  private _fitToPage = false;\n  private _externalLinkTarget = 'blank';\n  private _showBorders = false;\n  private lastLoaded: string | Uint8Array | PDFSource;\n  private _latestScrolledPage: number;\n\n  private resizeTimeout: number | null = null;\n  private pageScrollTimeout: number | null = null;\n  private isInitialized = false;\n  private loadingTask: PDFDocumentLoadingTask;\n  private destroy$ = new Subject<void>();\n\n  @Output('after-load-complete') afterLoadComplete = new EventEmitter<PDFDocumentProxy>();\n  @Output('page-rendered') pageRendered = new EventEmitter<CustomEvent>();\n  @Output('pages-initialized') pageInitialized = new EventEmitter<CustomEvent>();\n  @Output('text-layer-rendered') textLayerRendered = new EventEmitter<CustomEvent>();\n  @Output('error') onError = new EventEmitter<any>();\n  @Output('on-progress') onProgress = new EventEmitter<PDFProgressData>();\n  @Output() pageChange: EventEmitter<number> = new EventEmitter<number>(true);\n  @Input() src: string | Uint8Array | PDFSource;\n\n  @Input('c-maps-url')\n  set cMapsUrl(cMapsUrl: string) {\n    this._cMapsUrl = cMapsUrl;\n  }\n\n  @Input('page')\n  set page(_page) {\n    _page = parseInt(_page, 10) || 1;\n    const originalPage = _page;\n\n    if (this._pdf) {\n      _page = this.getValidPageNumber(_page);\n    }\n\n    this._page = _page;\n    if (originalPage !== _page) {\n      this.pageChange.emit(_page);\n    }\n  }\n\n  @Input('render-text')\n  set renderText(renderText: boolean) {\n    this._renderText = renderText;\n  }\n\n  @Input('render-text-mode')\n  set renderTextMode(renderTextMode: RenderTextMode) {\n    this._renderTextMode = renderTextMode;\n  }\n\n  @Input('original-size')\n  set originalSize(originalSize: boolean) {\n    this._originalSize = originalSize;\n  }\n\n  @Input('show-all')\n  set showAll(value: boolean) {\n    this._showAll = value;\n  }\n\n  @Input('stick-to-page')\n  set stickToPage(value: boolean) {\n    this._stickToPage = value;\n  }\n\n  @Input('zoom')\n  set zoom(value: number) {\n    if (value <= 0) {\n      return;\n    }\n\n    this._zoom = value;\n  }\n\n  get zoom() {\n    return this._zoom;\n  }\n\n  @Input('zoom-scale')\n  set zoomScale(value: 'page-height' | 'page-fit' | 'page-width') {\n    this._zoomScale = value;\n  }\n\n  get zoomScale() {\n    return this._zoomScale;\n  }\n\n  @Input('rotation')\n  set rotation(value: number) {\n    if (!(typeof value === 'number' && value % 90 === 0)) {\n      console.warn('Invalid pages rotation angle.');\n      return;\n    }\n\n    this._rotation = value;\n  }\n\n  @Input('external-link-target')\n  set externalLinkTarget(value: string) {\n    this._externalLinkTarget = value;\n  }\n\n  @Input('autoresize')\n  set autoresize(value: boolean) {\n    this._canAutoResize = Boolean(value);\n  }\n\n  @Input('fit-to-page')\n  set fitToPage(value: boolean) {\n    this._fitToPage = Boolean(value);\n  }\n\n  @Input('show-borders')\n  set showBorders(value: boolean) {\n    this._showBorders = Boolean(value);\n  }\n\n  static getLinkTarget(type: string) {\n    switch (type) {\n      case 'blank':\n        return (PDFJS as any).LinkTarget.BLANK;\n      case 'none':\n        return (PDFJS as any).LinkTarget.NONE;\n      case 'self':\n        return (PDFJS as any).LinkTarget.SELF;\n      case 'parent':\n        return (PDFJS as any).LinkTarget.PARENT;\n      case 'top':\n        return (PDFJS as any).LinkTarget.TOP;\n    }\n\n    return null;\n  }\n\n  constructor(private element: ElementRef<HTMLElement>, private ngZone: NgZone) {\n    if (isSSR()) {\n      return;\n    }\n\n    let pdfWorkerSrc: string;\n\n    if (\n      window.hasOwnProperty('pdfWorkerSrc') &&\n      typeof (window as any).pdfWorkerSrc === 'string' &&\n      (window as any).pdfWorkerSrc\n    ) {\n      pdfWorkerSrc = (window as any).pdfWorkerSrc;\n    } else {\n      pdfWorkerSrc = `https://cdn.jsdelivr.net/npm/pdfjs-dist@${(PDFJS as any).version\n        }/legacy/build/pdf.worker.js`;\n    }\n\n    assign(PDFJS.GlobalWorkerOptions, 'workerSrc', pdfWorkerSrc);\n  }\n\n  ngAfterViewChecked(): void {\n    if (this.isInitialized) {\n      return;\n    }\n\n    const offset = this.pdfViewerContainer.nativeElement.offsetParent;\n\n    if (this.isVisible === true && offset == null) {\n      this.isVisible = false;\n      return;\n    }\n\n    if (this.isVisible === false && offset != null) {\n      this.isVisible = true;\n\n      setTimeout(() => {\n        this.initialize();\n        this.ngOnChanges({ src: this.src } as any);\n      });\n    }\n  }\n\n  ngOnInit() {\n    this.initialize();\n    this.setupResizeListener();\n  }\n\n  ngOnDestroy() {\n    this.clear();\n    this.destroy$.next();\n    this.loadingTask = null;\n  }\n\n  get pdfLinkService(): any {\n    return this._showAll\n      ? this.pdfMultiPageLinkService\n      : this.pdfSinglePageLinkService;\n  }\n\n  get pdfViewer(): any {\n    return this.getCurrentViewer();\n  }\n\n  get pdfFindController(): any {\n    return this._showAll\n      ? this.pdfMultiPageFindController\n      : this.pdfSinglePageFindController;\n  }\n\n  ngOnChanges(changes: SimpleChanges) {\n    if (isSSR() || !this.isVisible) {\n      return;\n    }\n\n    if ('src' in changes) {\n      this.loadPDF();\n    } else if (this._pdf) {\n      if ('renderText' in changes) {\n        this.getCurrentViewer().textLayerMode = this._renderText\n          ? this._renderTextMode\n          : RenderTextMode.DISABLED;\n        this.resetPdfDocument();\n      } else if ('showAll' in changes) {\n        this.resetPdfDocument();\n      }\n      if ('page' in changes) {\n        const { page } = changes;\n        if (page.currentValue === this._latestScrolledPage) {\n          return;\n        }\n\n        // New form of page changing: The viewer will now jump to the specified page when it is changed.\n        // This behavior is introduced by using the PDFSinglePageViewer\n        this.getCurrentViewer().scrollPageIntoView({ pageNumber: this._page });\n      }\n\n      this.update();\n    }\n  }\n\n  public updateSize() {\n    const currentViewer = this.getCurrentViewer();\n\n    from(\n      (this._pdf.getPage(\n        currentViewer.currentPageNumber\n      ) as unknown) as Promise<PDFPageProxy>\n    )\n      .pipe(takeUntil(this.destroy$))\n      .subscribe({\n        next: (page: PDFPageProxy) => {\n          const rotation = this._rotation || page.rotate;\n          const viewportWidth =\n            (page as any).getViewport({\n              scale: this._zoom,\n              rotation\n            }).width * PdfViewerComponent.CSS_UNITS;\n          let scale = this._zoom;\n          let stickToPage = true;\n\n          // Scale the document when it shouldn't be in original size or doesn't fit into the viewport\n          if (\n            !this._originalSize ||\n            (this._fitToPage &&\n              viewportWidth > this.pdfViewerContainer.nativeElement.clientWidth)\n          ) {\n            const viewPort = (page as any).getViewport({ scale: 1, rotation });\n            scale = this.getScale(viewPort.width, viewPort.height);\n            stickToPage = !this._stickToPage;\n          }\n\n          currentViewer._setScale(scale, stickToPage);\n        }\n      });\n  }\n\n  public clear() {\n    if (this.loadingTask && !this.loadingTask.destroyed) {\n      this.loadingTask.destroy();\n    }\n\n    if (this._pdf) {\n      this._pdf.destroy();\n      this._pdf = null;\n      this.pdfMultiPageViewer.setDocument(null);\n      this.pdfSinglePageViewer.setDocument(null);\n\n      this.pdfMultiPageLinkService.setDocument(null, null);\n      this.pdfSinglePageLinkService.setDocument(null, null);\n\n      this.pdfMultiPageFindController.setDocument(null);\n      this.pdfSinglePageFindController.setDocument(null);\n    }\n  }\n\n  private getPDFLinkServiceConfig() {\n    const pdfLinkServiceConfig: any = {};\n    const linkTarget = PdfViewerComponent.getLinkTarget(this._externalLinkTarget);\n\n    if (linkTarget) {\n      pdfLinkServiceConfig.externalLinkTarget = linkTarget;\n    }\n\n    return pdfLinkServiceConfig;\n  }\n\n  private setupMultiPageViewer() {\n    assign(PDFJS, 'disableTextLayer', !this._renderText);\n\n    const eventBus = createEventBus(PDFJSViewer, this.destroy$);\n\n    fromEvent<CustomEvent>(eventBus, 'pagerendered')\n      .pipe(takeUntil(this.destroy$))\n      .subscribe((event) => {\n        this.pageRendered.emit(event);\n      });\n\n    fromEvent<CustomEvent>(eventBus, 'pagesinit')\n      .pipe(takeUntil(this.destroy$))\n      .subscribe((event) => {\n        this.pageInitialized.emit(event);\n      });\n\n    fromEvent(eventBus, 'pagechanging')\n      .pipe(takeUntil(this.destroy$))\n      .subscribe(({ pageNumber }) => {\n        if (this.pageScrollTimeout) {\n          clearTimeout(this.pageScrollTimeout);\n        }\n\n        this.pageScrollTimeout = window.setTimeout(() => {\n          this._latestScrolledPage = pageNumber;\n          this.pageChange.emit(pageNumber);\n        }, 100);\n      });\n\n    fromEvent<CustomEvent>(eventBus, 'textlayerrendered')\n      .pipe(takeUntil(this.destroy$))\n      .subscribe((event) => {\n        this.textLayerRendered.emit(event);\n      });\n\n    this.pdfMultiPageLinkService = new PDFJSViewer.PDFLinkService({\n      eventBus, ...this.getPDFLinkServiceConfig()\n    });\n    this.pdfMultiPageFindController = new PDFJSViewer.PDFFindController({\n      linkService: this.pdfMultiPageLinkService,\n      eventBus\n    });\n\n    const pdfOptions: PDFViewerOptions = {\n      eventBus,\n      container: this.element.nativeElement.querySelector('div'),\n      removePageBorders: !this._showBorders,\n      linkService: this.pdfMultiPageLinkService,\n      textLayerMode: this._renderText\n        ? this._renderTextMode\n        : RenderTextMode.DISABLED,\n      findController: this.pdfMultiPageFindController,\n      renderer: 'canvas',\n      l10n: undefined\n    };\n\n    this.pdfMultiPageViewer = new PDFJSViewer.PDFViewer(pdfOptions);\n    this.pdfMultiPageLinkService.setViewer(this.pdfMultiPageViewer);\n    this.pdfMultiPageFindController.setDocument(this._pdf);\n  }\n\n  private setupSinglePageViewer() {\n    assign(PDFJS, 'disableTextLayer', !this._renderText);\n\n    const eventBus = createEventBus(PDFJSViewer, this.destroy$);\n\n    fromEvent(eventBus, 'pagechanging')\n      .pipe(takeUntil(this.destroy$))\n      .subscribe(({ pageNumber }) => {\n        if (pageNumber !== this._page) {\n          this.page = pageNumber;\n        }\n      });\n\n    fromEvent<CustomEvent>(eventBus, 'pagerendered')\n      .pipe(takeUntil(this.destroy$))\n      .subscribe((event) => {\n        this.pageRendered.emit(event);\n      });\n\n    fromEvent<CustomEvent>(eventBus, 'pagesinit')\n      .pipe(takeUntil(this.destroy$))\n      .subscribe((event) => {\n        this.pageInitialized.emit(event);\n      });\n\n    fromEvent<CustomEvent>(eventBus, 'textlayerrendered')\n      .pipe(takeUntil(this.destroy$))\n      .subscribe((event) => {\n        this.textLayerRendered.emit(event);\n      });\n\n    this.pdfSinglePageLinkService = new PDFJSViewer.PDFLinkService({\n      eventBus, ...this.getPDFLinkServiceConfig()\n    });\n    this.pdfSinglePageFindController = new PDFJSViewer.PDFFindController({\n      linkService: this.pdfSinglePageLinkService,\n      eventBus\n    });\n\n    const pdfOptions = {\n      eventBus,\n      container: this.element.nativeElement.querySelector('div'),\n      removePageBorders: !this._showBorders,\n      linkService: this.pdfSinglePageLinkService,\n      textLayerMode: this._renderText\n        ? this._renderTextMode\n        : RenderTextMode.DISABLED,\n      findController: this.pdfSinglePageFindController\n    };\n\n    this.pdfSinglePageViewer = new PDFJSViewer.PDFSinglePageViewer(pdfOptions);\n    this.pdfSinglePageLinkService.setViewer(this.pdfSinglePageViewer);\n    this.pdfSinglePageFindController.setDocument(this._pdf);\n\n    this.pdfSinglePageViewer._currentPageNumber = this._page;\n  }\n\n  private getValidPageNumber(page: number): number {\n    if (page < 1) {\n      return 1;\n    }\n\n    if (page > this._pdf.numPages) {\n      return this._pdf.numPages;\n    }\n\n    return page;\n  }\n\n  private getDocumentParams() {\n    const srcType = typeof this.src;\n\n    if (!this._cMapsUrl) {\n      return this.src;\n    }\n\n    const params: any = {\n      cMapUrl: this._cMapsUrl,\n      cMapPacked: true\n    };\n\n    if (srcType === 'string') {\n      params.url = this.src;\n    } else if (srcType === 'object') {\n      if ((this.src as any).byteLength !== undefined) {\n        params.data = this.src;\n      } else {\n        Object.assign(params, this.src);\n      }\n    }\n\n    return params;\n  }\n\n  private loadPDF() {\n    if (!this.src) {\n      return;\n    }\n\n    if (this.lastLoaded === this.src) {\n      this.update();\n      return;\n    }\n\n    this.clear();\n\n    this.loadingTask = PDFJS.getDocument(this.getDocumentParams());\n\n    this.loadingTask.onProgress = (progressData: PDFProgressData) => {\n      this.onProgress.emit(progressData);\n    };\n\n    const src = this.src;\n\n    from(this.loadingTask.promise as Promise<PDFDocumentProxy>)\n      .pipe(takeUntil(this.destroy$))\n      .subscribe({\n        next: (pdf) => {\n          this._pdf = pdf;\n          this.lastLoaded = src;\n\n          this.afterLoadComplete.emit(pdf);\n\n          if (!this.pdfMultiPageViewer) {\n            this.setupMultiPageViewer();\n            this.setupSinglePageViewer();\n          }\n\n          this.resetPdfDocument();\n\n          this.update();\n        },\n        error: (error) => {\n          this.onError.emit(error);\n        }\n      });\n  }\n\n  private update() {\n    this.page = this._page;\n\n    this.render();\n  }\n\n  private render() {\n    this._page = this.getValidPageNumber(this._page);\n    const currentViewer = this.getCurrentViewer();\n\n    if (\n      this._rotation !== 0 ||\n      currentViewer.pagesRotation !== this._rotation\n    ) {\n      setTimeout(() => {\n        currentViewer.pagesRotation = this._rotation;\n      });\n    }\n\n    if (this._stickToPage) {\n      setTimeout(() => {\n        currentViewer.currentPageNumber = this._page;\n      });\n    }\n\n    this.updateSize();\n  }\n\n  private getScale(viewportWidth: number, viewportHeight: number) {\n    const borderSize = (this._showBorders ? 2 * PdfViewerComponent.BORDER_WIDTH : 0);\n    const pdfContainerWidth = this.pdfViewerContainer.nativeElement.clientWidth - borderSize;\n    const pdfContainerHeight = this.pdfViewerContainer.nativeElement.clientHeight - borderSize;\n\n    if (pdfContainerHeight === 0 || viewportHeight === 0 || pdfContainerWidth === 0 || viewportWidth === 0) {\n      return 1;\n    }\n\n    let ratio = 1;\n    switch (this._zoomScale) {\n      case 'page-fit':\n        ratio = Math.min((pdfContainerHeight / viewportHeight), (pdfContainerWidth / viewportWidth));\n        break;\n      case 'page-height':\n        ratio = (pdfContainerHeight / viewportHeight);\n        break;\n      case 'page-width':\n      default:\n        ratio = (pdfContainerWidth / viewportWidth);\n        break;\n    }\n\n    return (this._zoom * ratio) / PdfViewerComponent.CSS_UNITS;\n  }\n\n  private getCurrentViewer(): any {\n    return this._showAll ? this.pdfMultiPageViewer : this.pdfSinglePageViewer;\n  }\n\n  private resetPdfDocument() {\n    this.pdfFindController.setDocument(this._pdf);\n\n    if (this._showAll) {\n      this.pdfSinglePageViewer.setDocument(null);\n      this.pdfSinglePageLinkService.setDocument(null);\n\n      this.pdfMultiPageViewer.setDocument(this._pdf);\n      this.pdfMultiPageLinkService.setDocument(this._pdf, null);\n    } else {\n      this.pdfMultiPageViewer.setDocument(null);\n      this.pdfMultiPageLinkService.setDocument(null);\n\n      this.pdfSinglePageViewer.setDocument(this._pdf);\n      this.pdfSinglePageLinkService.setDocument(this._pdf, null);\n    }\n  }\n\n  private initialize(): void {\n    if (isSSR() || !this.isVisible) {\n      return;\n    }\n\n    this.isInitialized = true;\n    this.setupMultiPageViewer();\n    this.setupSinglePageViewer();\n  }\n\n  private setupResizeListener(): void {\n    if (isSSR()) {\n      return;\n    }\n\n    this.ngZone.runOutsideAngular(() => {\n      fromEvent(window, 'resize')\n        .pipe(\n          debounceTime(100),\n          filter(() => this._canAutoResize && !!this._pdf),\n          takeUntil(this.destroy$)\n        )\n        .subscribe(() => {\n          this.updateSize();\n        });\n    });\n  }\n}\n","import { fromEvent, Subject } from 'rxjs';\nimport { takeUntil } from 'rxjs/operators';\n\ninterface EventBus {\n  on(eventName: string, listener: Function): void;\n  off(eventName: string, listener: Function): void;\n}\n\nexport function createEventBus(pdfJsViewer: any, destroy$: Subject<void>) {\n  const globalEventBus: EventBus = new pdfJsViewer.EventBus();\n  attachDOMEventsToEventBus(globalEventBus, destroy$);\n  return globalEventBus;\n}\n\nfunction attachDOMEventsToEventBus(\n  eventBus: EventBus,\n  destroy$: Subject<void>\n): void {\n  fromEvent(eventBus, 'documentload')\n    .pipe(takeUntil(destroy$))\n    .subscribe(() => {\n      const event = document.createEvent('CustomEvent');\n      event.initCustomEvent('documentload', true, true, {});\n      window.dispatchEvent(event);\n    });\n\n  fromEvent(eventBus, 'pagerendered')\n    .pipe(takeUntil(destroy$))\n    .subscribe(({ pageNumber, cssTransform, source }) => {\n      const event = document.createEvent('CustomEvent');\n      event.initCustomEvent('pagerendered', true, true, {\n        pageNumber,\n        cssTransform,\n      });\n      source.div.dispatchEvent(event);\n    });\n\n  fromEvent(eventBus, 'textlayerrendered')\n    .pipe(takeUntil(destroy$))\n    .subscribe(({ pageNumber, source }) => {\n      const event = document.createEvent('CustomEvent');\n      event.initCustomEvent('textlayerrendered', true, true, { pageNumber });\n      source.textLayerDiv.dispatchEvent(event);\n    });\n\n  fromEvent(eventBus, 'pagechanging')\n    .pipe(takeUntil(destroy$))\n    .subscribe(({ pageNumber, source }) => {\n      const event = document.createEvent('UIEvents');\n      event.initEvent('pagechanging', true, true);\n      /* tslint:disable:no-string-literal */\n      event['pageNumber'] = pageNumber;\n      source.container.dispatchEvent(event);\n    });\n\n  fromEvent(eventBus, 'pagesinit')\n    .pipe(takeUntil(destroy$))\n    .subscribe(({ source }) => {\n      const event = document.createEvent('CustomEvent');\n      event.initCustomEvent('pagesinit', true, true, null);\n      source.container.dispatchEvent(event);\n    });\n\n  fromEvent(eventBus, 'pagesloaded')\n    .pipe(takeUntil(destroy$))\n    .subscribe(({ pagesCount, source }) => {\n      const event = document.createEvent('CustomEvent');\n      event.initCustomEvent('pagesloaded', true, true, { pagesCount });\n      source.container.dispatchEvent(event);\n    });\n\n  fromEvent(eventBus, 'scalechange')\n    .pipe(takeUntil(destroy$))\n    .subscribe(({ scale, presetValue, source }) => {\n      const event = document.createEvent('UIEvents');\n      event.initEvent('scalechange', true, true);\n      /* tslint:disable:no-string-literal */\n      event['scale'] = scale;\n      /* tslint:disable:no-string-literal */\n      event['presetValue'] = presetValue;\n      source.container.dispatchEvent(event);\n    });\n\n  fromEvent(eventBus, 'updateviewarea')\n    .pipe(takeUntil(destroy$))\n    .subscribe(({ location, source }) => {\n      const event = document.createEvent('UIEvents');\n      event.initEvent('updateviewarea', true, true);\n      event['location'] = location;\n      source.container.dispatchEvent(event);\n    });\n\n  fromEvent(eventBus, 'find')\n    .pipe(takeUntil(destroy$))\n    .subscribe(\n      ({\n        source,\n        type,\n        query,\n        phraseSearch,\n        caseSensitive,\n        highlightAll,\n        findPrevious,\n      }) => {\n        if (source === window) {\n          return; // event comes from FirefoxCom, no need to replicate\n        }\n        const event = document.createEvent('CustomEvent');\n        event.initCustomEvent('find' + type, true, true, {\n          query,\n          phraseSearch,\n          caseSensitive,\n          highlightAll,\n          findPrevious,\n        });\n        window.dispatchEvent(event);\n      }\n    );\n\n  fromEvent(eventBus, 'attachmentsloaded')\n    .pipe(takeUntil(destroy$))\n    .subscribe(({ attachmentsCount, source }) => {\n      const event = document.createEvent('CustomEvent');\n      event.initCustomEvent('attachmentsloaded', true, true, {\n        attachmentsCount,\n      });\n      source.container.dispatchEvent(event);\n    });\n\n  fromEvent(eventBus, 'sidebarviewchanged')\n    .pipe(takeUntil(destroy$))\n    .subscribe(({ view, source }) => {\n      const event = document.createEvent('CustomEvent');\n      event.initCustomEvent('sidebarviewchanged', true, true, { view });\n      source.outerContainer.dispatchEvent(event);\n    });\n\n  fromEvent(eventBus, 'pagemode')\n    .pipe(takeUntil(destroy$))\n    .subscribe(({ mode, source }) => {\n      const event = document.createEvent('CustomEvent');\n      event.initCustomEvent('pagemode', true, true, { mode });\n      source.pdfViewer.container.dispatchEvent(event);\n    });\n\n  fromEvent(eventBus, 'namedaction')\n    .pipe(takeUntil(destroy$))\n    .subscribe(({ action, source }) => {\n      const event = document.createEvent('CustomEvent');\n      event.initCustomEvent('namedaction', true, true, { action });\n      source.pdfViewer.container.dispatchEvent(event);\n    });\n\n  fromEvent(eventBus, 'presentationmodechanged')\n    .pipe(takeUntil(destroy$))\n    .subscribe(({ active, switchInProgress }) => {\n      const event = document.createEvent('CustomEvent');\n      event.initCustomEvent('presentationmodechanged', true, true, {\n        active,\n        switchInProgress,\n      });\n      window.dispatchEvent(event);\n    });\n\n  fromEvent(eventBus, 'outlineloaded')\n    .pipe(takeUntil(destroy$))\n    .subscribe(({ outlineCount, source }) => {\n      const event = document.createEvent('CustomEvent');\n      event.initCustomEvent('outlineloaded', true, true, { outlineCount });\n      source.container.dispatchEvent(event);\n    });\n}\n","export function assign(obj: Object, prop: string, value: any) {\n  obj[prop] = value;\n}\n\nexport function isSSR() {\n  return typeof window === 'undefined';\n}","/**\n * Created by vadimdez on 01/11/2016.\n */\nimport { NgModule } from '@angular/core';\n\nimport { PdfViewerComponent } from './pdf-viewer.component';\n\nexport * from './typings';\n\n@NgModule({\n  declarations: [PdfViewerComponent],\n  exports: [PdfViewerComponent]\n})\nexport class PdfViewerModule {}\n"]}